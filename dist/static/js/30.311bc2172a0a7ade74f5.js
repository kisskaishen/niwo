webpackJsonp([30],{fTNc:function(e,t){},hiAZ:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("3cXf"),a=o.n(r),s={name:"pages_kingForm",data:function(){return{pageName:"添加冠军/挑战者",kingData:[],scoreKingData:[]}},created:function(){},mounted:function(){"5"==this.$route.query.moldType&&("{}"!=a()(this.$local.get("formList"))?this.scoreKingData=this.$local.get("formList"):this.getList())},methods:{getList:function(){var e=this;this.$post("/mcs/node/mold/query",{nodeId:this.$route.query.nodeId.slice(4)}).then(function(t){"5"==e.$route.query.moldType&&(t.bindMoldList.length>0?(e.scoreKingData=t.bindMoldList,e.$local.set("formList",t.bindMoldList)):e.scoreKingData=[{scorecardName:"选择模型",rate:""}]),console.log(e.scoreKingData)})},addCeLue:function(){this.scoreKingData.push({scorecardName:"选择模型",rate:""})},deleteCeLue:function(e){this.scoreKingData.splice(e.$index,1),this.$local.set("formList",this.scoreKingData)},newCeLue:function(e){switch(this.$route.query.needMoldType){case"1":this.$router.push({path:this.$route.fullPath.replace("/kingForm","/outFrandForm"),query:{from:"kingForm"}});break;case"3":this.$router.push({path:this.$route.fullPath.replace("/kingForm","/creditForm"),query:{from:"kingForm"}});break;case"4":this.$router.push({path:this.$route.fullPath.replace("/kingForm","/scoreCardForm"),query:{from:"kingForm"}})}void 0==e.row.id?this.$local.delete("formId"):this.$local.set("creditFormId",e.row.id),this.$local.set("formIndex",e.$index+1)},saveBtn:function(){var e=this;this.scoreKingData.map(function(t,o,r){""==t.policyName||""==t.rate?e.$message.error("保存失败，配置内容不全"):t.rate<=0?e.$message.error("流量值必须大于0"):t.rate>1&&e.$message.error("流量值不能大于1"),t.bindId||(t.bindId=t.id,t.bindName=t.moldName)}),this.$post("/mcs/node/mold/bind",{nodeId:this.$route.query.nodeId.slice(4),bindMoldList:this.scoreKingData}).then(function(t){e.$message.success("添加成功");var o=e.$route.fullPath.replace("&from=kingForm","").replace("/kingForm","");e.$router.push(o),e.$local.delete("formList"),setTimeout(function(){location.reload()},300)})}},beforeDestroy:function(){}},i={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"pages_kingForm"},[o("h2",[e._v(e._s(e.pageName))]),e._v(" "),"5"==e.$route.query.moldType?o("el-table",{attrs:{data:e.scoreKingData,"header-row-class-name":"table_hd","header-cell-class-name":"table_th","row-class-name":"table_tr","cell-class-name":"table_td"}},[o("el-table-column",{attrs:{prop:"text",label:"模型名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("p",{staticClass:"name primaryColor",on:{click:function(o){e.newCeLue(t)}}},[e._v("\n                    "+e._s(t.row.scorecardName||t.row.bindName||t.row.moldName))]),e._v(" "),"edit"==e.$route.query.type?o("div",{staticClass:"iconDiv"},[o("i",{staticClass:"el-icon-circle-plus-outline",on:{click:function(o){e.addCeLue(t)}}}),e._v(" "),e.scoreKingData.length>1?o("i",{staticClass:"el-icon-delete",on:{click:function(o){e.deleteCeLue(t)}}}):e._e()]):e._e()]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"number",label:"流量"},scopedSlots:e._u([{key:"default",fn:function(t){return["look"==e.$route.query.type?o("p",[e._v(e._s(t.row.rate))]):o("el-input",{attrs:{maxLength:"4",size:"mini",placeholder:"支持两位小数"},model:{value:t.row.rate,callback:function(o){e.$set(t.row,"rate",e._n(o))},expression:"scope.row.rate"}})]}}])})],1):e._e(),e._v(" "),o("p",{staticStyle:{"margin-bottom":"40px",color:"#ccc"}},[e._v("注：当仅含1个模型元件且流量=1，即代表该模型无挑战者")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.saveBtn}},[e._v("保存")])],1)},staticRenderFns:[]};var n=o("C7Lr")(s,i,!1,function(e){o("fTNc")},null,null);t.default=n.exports}});