webpackJsonp([31],{"/Ylf":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"pages_distAdd"},[t("el-form",{ref:"modelForm",staticClass:"modelForm inlineBlock mg_t_20",attrs:{"status-icon":"","label-position":"left"}},[t("el-form-item",{staticClass:"fl mg_r_20 productList",attrs:{label:"请选择产品线：","label-width":"110px"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择",size:"medium"},on:{change:e.productChange},model:{value:e.modelForm.appId,callback:function(a){e.$set(e.modelForm,"appId",a)},expression:"modelForm.appId"}},e._l(e.products,function(e,a){return t("el-option",{key:e.appId,attrs:{label:e.productName,value:e.appId}})}))],1),e._v(" "),t("el-form-item",{staticClass:"fl mg_r_20 moldName",attrs:{label:"请选择变量类型：","label-width":"120px"}},[t("el-select",{attrs:{filterable:"",placeholder:"请选择",size:"medium"},on:{change:function(a){e.vLock=!1}},model:{value:e.modelForm.source,callback:function(a){e.$set(e.modelForm,"source",a)},expression:"modelForm.source"}},[t("el-option",{attrs:{label:"输入变量",value:"2"}})],1)],1)],1),e._v(" "),2==e.modelForm.source?t("el-table",{staticClass:"productListTable mg_t_20",attrs:{data:e.tabList,border:"","header-row-class-name":"table_hd","header-cell-class-name":"table_th","row-class-name":"table_tr","cell-class-name":"table_td"}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),e._v(" "),t("el-table-column",{attrs:{label:"变量名(中文)",prop:"variableName",width:"270"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{class:{solid_red:e.vLock&&!a.row.variableNameEn},staticStyle:{width:"150px"},model:{value:a.row.variableName,callback:function(t){e.$set(a.row,"variableName",t)},expression:"scope.row.variableName"}}),e._v(" "),t("a",{staticClass:"mg_l_20",attrs:{href:"javascript:;"},on:{click:e.addTabItem}},[t("i",{staticClass:"icon icon-add"})]),e._v(" "),t("a",{staticClass:"mg_l_10",attrs:{href:"javascript:;"},on:{click:function(t){e.removeTabItem(a.$index)}}},[t("i",{staticClass:"icon icon-del"})])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"字段名(英文)",prop:"variableNameEn"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{class:{solid_red:e.vLock&&!a.row.variableName},model:{value:a.row.variableNameEn,callback:function(t){e.$set(a.row,"variableNameEn",t)},expression:"scope.row.variableNameEn"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"变量类型",prop:"variableType"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{class:{solid_red:e.vLock&&!a.row.variableType},staticStyle:{width:"100%"},model:{value:a.row.variableType,callback:function(t){e.$set(a.row,"variableType",t)},expression:"scope.row.variableType"}},[t("el-option",{attrs:{value:"1",label:"字符串"}}),e._v(" "),t("el-option",{attrs:{value:"2",label:"整型"}}),e._v(" "),t("el-option",{attrs:{value:"3",label:"浮点型"}}),e._v(" "),t("el-option",{attrs:{value:"4",label:"日期型"}}),e._v(" "),t("el-option",{attrs:{value:"6",label:"布尔型"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"是否必填"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{staticStyle:{width:"100%"},model:{value:a.row.necessary,callback:function(t){e.$set(a.row,"necessary",t)},expression:"scope.row.necessary"}},[t("el-option",{attrs:{value:1,label:"必填"}}),e._v(" "),t("el-option",{attrs:{value:0,label:"非必填"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"备注"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{model:{value:a.row.remark,callback:function(t){e.$set(a.row,"remark",t)},expression:"scope.row.remark"}})]}}])})],1):e._e(),e._v(" "),t("el-button",{staticClass:"mg_t_20",attrs:{type:"primary",size:"medium"},on:{click:e.addDictItem}},[e._v("保存")])],1)},staticRenderFns:[]};var s=t("C7Lr")({name:"pages_distAdd",data:function(){return{modelForm:{appId:"",source:"2"},tabList:[{scorecardId:"",variableNameEn:"",variableName:"",remark:"",scorecardList:[],variableType:"",necessary:1}],products:[],scorecards:[],vLock:!1}},watch:{"modelForm.source":function(){this.tabList=[{scorecardId:"",variableNameEn:"",variableName:"",remark:"",scorecardList:[],variableType:"",necessary:1}]}},created:function(){this.productList()},methods:{productChange:function(e){this.vLock=!1,this.modelForm.appId=e,this.tabList=[{scorecardId:"",variableNameEn:"",variableName:"",remark:"",scorecardList:[],variableType:"",necessary:1}],this.scorecardList()},productList:function(){var e=this;this.$post("/mcs/product/list",{pageNo:"-1"}).then(function(a){e.products=a.productList,e.modelForm.appId=a.productList[0].appId,e.scorecardList()})},scorecardList:function(){var e=this;this.$post("/mcs/scorecard/list",{appId:this.modelForm.appId}).then(function(a){e.tabList.map(function(e){return e.scorecardList=a.scorecardList,e}),e.scorecards=a.scorecardList})},addTabItem:function(){this.tabList.push({scorecardId:"",variableNameEn:"",variableName:"",remark:"",scorecardList:this.scorecards,variableType:"",necessary:1})},removeTabItem:function(e){this.tabList.length>1&&this.tabList.splice(e,1)},validateFrom:function(){return 1==this.modelForm.source?this.tabList.every(function(e){return!!e.scorecardId&&!!e.variableName&&!!e.variableNameEn}):2==this.modelForm.source?this.tabList.every(function(e){return!!e.variableName&&!!e.variableNameEn&&!!e.variableType}):void 0},addDictItem:function(){var e=this;if(this.validateFrom()){var a=[];this.tabList.forEach(function(e){a.push({scorecardId:e.scorecardId,variableNameEn:e.variableNameEn,variableName:e.variableName,remark:e.remark,variableType:e.variableType,necessary:e.necessary})}),this.$post("/mcs/variable/create",{appId:this.modelForm.appId,source:this.modelForm.source,variableList:a}).then(function(a){e.$message.success("保存成功"),e.$router.push("/risk/dictMg/dictList")})}else{this.vLock=!0;var t="";this.tabList.map(function(e,a,r){""==e.variableNameEn?t="请输入字段名(英文)":""==e.variableName?t="请输入变量名(中文)":""==e.variableType&&(t="请选择变量类型")}),this.$message({message:t,type:"warning"})}}}},r,!1,function(e){t("BC+I")},"data-v-76c560b0",null);a.default=s.exports},"BC+I":function(e,a){}});