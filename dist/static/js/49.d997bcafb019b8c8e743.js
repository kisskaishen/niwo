webpackJsonp([49],{MAhz:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pages_dictCustomAdd"},[a("el-form",{ref:"modelForm",staticClass:"modelForm inlineBlock mg_t_20",attrs:{"status-icon":"","label-position":"left"}},[a("el-form-item",{staticClass:"fl mg_r_20 productList",attrs:{label:"请选择产品线：","label-width":"110px"}},[a("el-select",{class:{solid_red:t.vLock&&!t.modelForm.appId},attrs:{filterable:"",placeholder:"请选择",size:"medium",disabled:"view"==t.$route.query.type},model:{value:t.modelForm.appId,callback:function(e){t.$set(t.modelForm,"appId",e)},expression:"modelForm.appId"}},t._l(t.products,function(t,e){return a("el-option",{key:t.appId,attrs:{label:t.productName,value:t.appId}})}))],1)],1),t._v(" "),a("el-table",{staticClass:"productListTable mg_t_20",attrs:{data:t.tabList,border:"","header-row-class-name":"table_hd","header-cell-class-name":"table_th","row-class-name":"table_tr",fit:!0,"cell-class-name":"table_td"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"自定义列表名称(中文)",prop:"variableNameEn"},scopedSlots:t._u([{key:"default",fn:function(e){return["edit"==t.type||"add"==t.type?a("div",[a("el-input",{class:{solid_red:t.vLock&&!e.row.setName||e.row.isRepeat},staticStyle:{width:"200px",display:"inline-block"},on:{blur:function(a){t.checkRepeat(e.row)}},model:{value:e.row.setName,callback:function(a){t.$set(e.row,"setName",a)},expression:"scope.row.setName"}}),t._v(" "),a("a",{staticClass:"mg_l_20",attrs:{href:"javascript:;"},on:{click:t.addTabItem}},["add"==t.type?a("i",{staticClass:"icon icon-add"}):t._e()]),t._v(" "),"add"==t.type?a("a",{staticClass:"mg_l_10",attrs:{href:"javascript:;"},on:{click:function(a){t.removeTabItem(e.$index)}}},[a("i",{staticClass:"icon icon-del"})]):t._e()],1):a("div",[t._v("\n                    "+t._s(e.row.setName)+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"数据类型",prop:"variableName"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                string\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"条件",prop:"remark"},scopedSlots:t._u([{key:"default",fn:function(e){return["edit"==t.type||"add"==t.type?a("div",t._l(e.row.data,function(s,i){return a("div",{staticClass:"condition-item"},[a("el-input",{class:{solid_red:t.vLock&&!s.key},staticStyle:{width:"200px",display:"inline-block"},model:{value:s.key,callback:function(e){t.$set(s,"key",e)},expression:"item.key"}}),t._v(" "),a("a",{staticClass:"mg_l_20",attrs:{href:"javascript:;"},on:{click:function(a){t.addConditionItem(e.$index)}}},[a("i",{staticClass:"icon icon-add"})]),t._v(" "),a("a",{staticClass:"mg_l_10",attrs:{href:"javascript:;"},on:{click:function(a){t.removeConditionItem(e.$index,i)}}},[a("i",{staticClass:"icon icon-del"})])],1)})):a("div",t._l(e.row.data,function(e,s){return a("div",{staticClass:"condition-item"},[t._v("\n                        "+t._s(e.key)+"\n                    ")])}))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"remark"},scopedSlots:t._u([{key:"default",fn:function(e){return["edit"==t.type||"add"==t.type?a("div",[a("el-input",{model:{value:e.row.remark,callback:function(a){t.$set(e.row,"remark",a)},expression:"scope.row.remark"}})],1):a("div",[t._v("\n                    "+t._s(e.row.remark)+"\n                ")])]}}])})],1),t._v(" "),"edit"==t.type||"add"==t.type?a("el-button",{staticClass:"mg_t_20",attrs:{type:"primary",size:"medium"},on:{click:t.addDistCustom}},[t._v("保存\n    ")]):t._e()],1)},staticRenderFns:[]};var i=a("C7Lr")({name:"pages_dictCustomAdd",data:function(){return{modelForm:{appId:""},tabList:[{setName:"",isRepeat:!1,data:[{key:""}]}],products:[],scorecards:[],type:this.$route.query.type||"add",id:this.$route.query.id,vLock:!1}},mounted:function(){"add"!=this.type&&this.getSetQuery(),this.productList()},methods:{checkRepeat:function(t){},getSetQuery:function(){var t=this;this.$post("/mcs/set/query",{id:this.id}).then(function(e){t.modelForm.appId=e.data.appId;var a=e,s=[];a.data.map(function(t){s.push({key:t})}),a.data=s,"view"!=t.type&&"edit"!=t.type||(t.tabList=[a])})},productList:function(){var t=this;this.$post("/mcs/product/list",{}).then(function(e){t.products=e.productList})},addTabItem:function(){this.tabList.push({setName:"",isRepeat:!1,data:[{key:""}]})},removeTabItem:function(t){var e=this;this.tabList.length>1&&this.$msgbox.confirm("",{title:"系统提示",message:'<p class="f_333">确认要删除该列表？',dangerouslyUseHTMLString:!0,type:"warning"}).then(function(){e.tabList.splice(t,1)})},addConditionItem:function(t){this.tabList[t].data.push({key:""})},removeConditionItem:function(t,e){var a=this;this.$msgbox.confirm("",{title:"系统提示",message:'<p class="f_333">确认要删除该条件？',dangerouslyUseHTMLString:!0,type:"warning"}).then(function(){a.tabList[t].data.splice(e,1)})},validate:function(){return this.vLock=!0,!!this.modelForm.appId&&this.tabList.every(function(t,e){return!!t.setName&&t.data.every(function(t,e){return!!t.key})})},addDistCustom:function(){var t=this;if(this.validate()){for(var e=[],a=0;a<this.tabList.length;a++){var s={setName:this.tabList[a].setName,remark:this.tabList[a].remark,appId:this.modelForm.appId};this.tabList[a].id&&(s.id=this.tabList[a].id);for(var i=[],o=0;o<this.tabList[a].data.length;o++)i.push(this.tabList[a].data[o].key);s.data=i,e.push(s)}var n="add"==this.type?"/mcs/set/create":"/mcs/set/update";"edit"==this.type&&(e=e[0]),this.$post(n,e).then(function(e){t.type,t.$message.success(t.type),t.$router.push("/risk/dictMg/dictCustom")})}}}},s,!1,function(t){a("amVR")},"data-v-1b1efaec",null);e.default=i.exports},amVR:function(t,e){}});