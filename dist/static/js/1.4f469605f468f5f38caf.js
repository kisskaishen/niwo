webpackJsonp([1],{"1ts/":function(e,t){},AzOn:function(e,t){},Nc2L:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=r("aA9S"),a=r.n(l),i={name:"pages_ruleForm",data:function(){return{pageName:"pages_ruleForm",rules:{},varLogicList:[{id:1,name:"AND"},{id:2,name:"OR"}],oprList:[{id:1,name:"="},{id:2,name:"!="},{id:3,name:"is null"},{id:4,name:">"},{id:5,name:">="},{id:6,name:"<"},{id:7,name:"<="},{id:8,name:"startsWith"},{id:9,name:"contains"}],oprList_str:[{id:1,name:"="},{id:2,name:"!="},{id:3,name:"is null"},{id:8,name:"startsWith"},{id:9,name:"contains"}],oprList_num:[{id:1,name:"="},{id:2,name:"!="},{id:4,name:">"},{id:5,name:">="},{id:6,name:"<"},{id:7,name:"<="}],oprList_bl:[{id:"1",name:"是"},{id:"0",name:"否"}],ruleForm:{appId:"",id:"",ruleName:"",decisionCode:"",logic:"",ruleConShow:!0,ruleContent:[{variableId:"",variableName:"",variableType:"",logic:1,oprList:[],content:[]}],isTemplate:1},vLock:!1}},props:["icon","variableList","appId"],components:{varItem:r("+eba").a},created:function(){this.$route.query.appId?this.ruleForm.appId=this.$route.query.appId:this.appId&&(this.ruleForm.appId=this.appId)},methods:{getRuleDetail:function(){var e=this;this.$post("/mcs/rule/query",{id:this.$route.query.ruleId}).then(function(t){t.ruleContent.map(function(t,r){t.sort=r,t.operationArray=t.content.map(function(e){return e.operationValue}),t.oprList=[],e.$emit("getVarType",t,r,0)}),a()(e.ruleForm,t)})},arrowLeft:function(){console.log(this.$route.name),"strat_ruleForm"==this.$route.name?this.$router.push({path:"/risk/modelMg/modelUml/stratForm",query:this.$route.query}):"parallelForm_ruleForm"==this.$route.name||"parallelForm_stratForm_ruleForm"==this.$route.name?this.$router.push({path:"/risk/modelMg/modelUml/parallelForm",query:this.$route.query}):"stratAdd_ruleForm"==this.$route.name&&this.$router.push({path:"/risk/stratMg/stratList/stratAdd",query:this.$route.query})},saveRule:function(){if(this.validateRule(this.ruleForm))console.log("规则保存》》》",this.$route.name,this.ruleForm.isTemplate),"ruleTmpAdd"==this.$route.name||"ruleTmpEdit"==this.$route.name||this.$route.name.indexOf("_ruleForm")>-1?"0"===this.ruleForm.isTemplate?this.createRule():this.$emit("createRuleSuccess",this.ruleForm):this.createRule();else{var e="";e=""==this.ruleForm.ruleName?"请输入规则名称":""==this.ruleForm.logic?"请选择规则执行条件":""==this.ruleForm.decisionCode?"请输入决策代码":""==this.ruleForm.decisionCode?"请输入决策代码":"请填写完全决策信息",this.$notify({message:e,type:"warning"})}},validateRule:function(e){var t=this;this.vLock=!0;var r=e.ruleContent.filter(function(e){return console.log("【ruleConNum】",e.variableName,!(e.content.length>1)||e.logic,t.$refs.varItem.validateVar(e)),!!e.variableName&&(!(e.content.length>1)||e.logic)&&t.$refs.varItem.validateVar(e)}).length;return!!this.ruleForm.ruleName&&this.ruleForm.logic&&this.ruleForm.decisionCode&&r==e.ruleContent.length},createRule:function(){var e=this;console.log("创建规则"),this.$post("/mcs/rule/create",this.ruleForm).then(function(t){e.ruleForm.id=t.id,e.$emit("createRuleSuccess",e.ruleForm),e.resetRuleForm()})},resetRuleForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.ruleForm={appId:e,id:"",ruleName:"",decisionCode:"",logic:"",ruleConShow:!1,ruleContent:[{variableId:"",variableName:"",variableType:"",logic:1,oprList:[],content:[]}],isTemplate:1},this.vLock=!1},ruleCon_plus:function(e,t){this.$refs.varItem.$refs.variableName.ruleCon_plus(e,t)},getVarType:function(e){this.$emit("getVarType",e)}}},o={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pages_ruleForm"},[r("el-form",{ref:"ruleForm",staticClass:"stratForm ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules}},["ruleTmpAdd"!=e.$route.name&&"ruleTmpEdit"!=e.$route.name?r("img",{staticClass:"backTostratName pointer",attrs:{src:e.icon.arrowLeft,alt:"返回策略名称"},on:{click:e.arrowLeft}}):e._e(),e._v(" "),r("el-form-item",{staticClass:"ruleName",attrs:{label:""}},[r("el-input",{staticClass:"w310",class:{solid_red:e.vLock&&!e.ruleForm.ruleName},attrs:{placeholder:"请输入规则名称",size:"medium",clearable:""},model:{value:e.ruleForm.ruleName,callback:function(t){e.$set(e.ruleForm,"ruleName",t)},expression:"ruleForm.ruleName"}})],1),e._v(" "),r("el-form-item",{staticClass:"ruleConItem noBorder pd_0",attrs:{label:"规则执行条件：",prop:"logic"}},[r("el-radio-group",{class:{solid_red:e.vLock&&!e.ruleForm.logic},model:{value:e.ruleForm.logic,callback:function(t){e.$set(e.ruleForm,"logic",e._n(t))},expression:"ruleForm.logic"}},["look"!=e.$route.query.type||2==e.item.logic?r("el-radio",{attrs:{label:2}},[e._v("满足任意条件")]):e._e(),e._v(" "),"look"!=e.$route.query.type||1==e.item.logic?r("el-radio",{attrs:{label:1}},[e._v("满足全部条件")]):e._e()],1)],1),e._v(" "),r("el-form-item",{staticClass:"ruleName",attrs:{label:"决策代码"}},[r("el-input",{staticClass:"w310",class:{solid_red:e.vLock&&!e.ruleForm.decisionCode},attrs:{placeholder:"请输入决策代码",size:"medium",clearable:""},model:{value:e.ruleForm.decisionCode,callback:function(t){e.$set(e.ruleForm,"decisionCode",t)},expression:"ruleForm.decisionCode"}})],1),e._v(" "),r("div",{staticClass:"stratForm_rule"},[r("el-form-item",{staticClass:"stratForm_bd"},[r("div",{staticClass:"ruleList"},[e.ruleForm.ruleContent.length?r("div",{staticClass:"ruleContent clear open"},[r("varItem",{ref:"varItem",staticClass:"ruleConItem overhide",attrs:{icon:e.icon,variableList:e.variableList,item:e.ruleForm,index:"",vLock:e.vLock},on:{getVarType:e.getVarType}})],1):r("div",{staticClass:"noResult bd_t_0 bd_l_0 bd_r_0"},[e._v("竟然删空了，去"),r("span",{staticClass:"f_blue pointer",on:{click:function(t){e.ruleCon_plus(e.ruleForm)}}},[e._v("添加变量")])])])]),e._v(" "),"ruleTmpAdd"!=e.$route.name&&"ruleTmpEdit"!=e.$route.name?r("el-form-item",{staticClass:"isTemplate",attrs:{label:""}},[r("el-checkbox",{attrs:{"true-label":"0","false-label":"1"},model:{value:e.ruleForm.isTemplate,callback:function(t){e.$set(e.ruleForm,"isTemplate",t)},expression:"ruleForm.isTemplate"}},[e._v("保存为规则模板")])],1):e._e()],1),e._v(" "),r("div",{staticStyle:{"margin-top":"40px"}},["look"!=e.$route.query.type?r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.saveRule}},[e._v("保存\n            ")]):e._e()],1)],1)],1)},staticRenderFns:[]};var s=r("C7Lr")(i,o,!1,function(e){r("AzOn")},"data-v-b2fb64ee",null);t.default=s.exports},dIag:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=r("aA9S"),a=r.n(l),i={name:"pages_ruleForm",data:function(){return{pageName:"pages_ruleForm",rules:{},varLogicList:[{id:1,name:"AND"},{id:2,name:"OR"}],oprList:[{id:1,name:"="},{id:2,name:"!="},{id:3,name:"is null"},{id:4,name:">"},{id:5,name:">="},{id:6,name:"<"},{id:7,name:"<="},{id:8,name:"startsWith"},{id:9,name:"contains"}],oprList_str:[{id:1,name:"="},{id:2,name:"!="},{id:3,name:"is null"},{id:8,name:"startsWith"},{id:9,name:"contains"}],oprList_num:[{id:1,name:"="},{id:2,name:"!="},{id:4,name:">"},{id:5,name:">="},{id:6,name:"<"},{id:7,name:"<="}],oprList_bl:[{id:"1",name:"是"},{id:"0",name:"否"}],ruleForm:{appId:"",id:"",ruleName:"",decisionCode:"",logic:"",ruleConShow:!0,ruleContent:[{variableId:"",variableName:"",variableType:"",logic:1,oprList:[],content:[]}],isTemplate:1},vLock:!1}},props:["icon","variableList","appId"],components:{varItem:r("+eba").a},created:function(){this.$route.query.appId?this.ruleForm.appId=this.$route.query.appId:this.appId&&(this.ruleForm.appId=this.appId)},methods:{getRuleDetail:function(){var e=this;this.$post("/mcs/rule/query",{id:this.$route.query.ruleId}).then(function(t){t.ruleContent.map(function(t,r){t.sort=r,t.operationArray=t.content.map(function(e){return e.operationValue}),t.oprList=[],e.$emit("getVarType",t,r,0)}),a()(e.ruleForm,t)})},arrowLeft:function(){this.$router.push({path:"/risk/modelMg/modelUml/parallelForm",query:this.$route.query})},saveRule:function(){if(this.validateRule(this.ruleForm))console.log("规则保存》》》",this.$route.name,this.ruleForm.isTemplate),"ruleTmpAdd"==this.$route.name||"ruleTmpEdit"==this.$route.name||this.$route.name.indexOf("_ruleForm")>-1?"0"===this.ruleForm.isTemplate?this.createRule():this.$emit("createRuleSuccess",this.ruleForm):this.createRule();else{var e="";e=""==this.ruleForm.ruleName?"请输入规则名称":""==this.ruleForm.logic?"请选择规则执行条件":""==this.ruleForm.decisionCode?"请输入决策代码":""==this.ruleForm.decisionCode?"请输入决策代码":"请填写完全决策信息",this.$notify({message:e,type:"warning"})}},validateRule:function(e){var t=this;this.vLock=!0;var r=e.ruleContent.filter(function(e){return console.log("【ruleConNum】",e.variableName,!(e.content.length>1)||e.logic,t.$refs.varItem.validateVar(e)),!!e.variableName&&(!(e.content.length>1)||e.logic)&&t.$refs.varItem.validateVar(e)}).length;return!!this.ruleForm.ruleName&&this.ruleForm.logic&&this.ruleForm.decisionCode&&r==e.ruleContent.length},createRule:function(){var e=this;console.log("创建规则"),this.$post("/mcs/rule/create",this.ruleForm).then(function(t){e.ruleForm.id=t.id,e.$emit("createRuleSuccess",e.ruleForm),e.resetRuleForm()})},resetRuleForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.ruleForm={appId:e,id:"",ruleName:"",decisionCode:"",logic:"",ruleConShow:!1,ruleContent:[{variableId:"",variableName:"",variableType:"",logic:1,oprList:[],content:[]}],isTemplate:1},this.vLock=!1},ruleCon_plus:function(e,t){this.$refs.varItem.$refs.variableName.ruleCon_plus(e,t)},getVarType:function(e){console.log("请求类型"),console.log(e),console.log(this),this.$emit("getVarType",e)}}},o={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pages_ruleForm"},[r("el-form",{ref:"ruleForm",staticClass:"stratForm ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules}},["ruleTmpAdd"!=e.$route.name&&"ruleTmpEdit"!=e.$route.name?r("img",{staticClass:"backTostratName pointer",attrs:{src:e.icon.arrowLeft,alt:"返回策略名称"},on:{click:e.arrowLeft}}):e._e(),e._v(" "),r("el-form-item",{staticClass:"ruleName",attrs:{label:""}},[r("el-input",{staticClass:"w310",class:{solid_red:e.vLock&&!e.ruleForm.ruleName},attrs:{placeholder:"请输入规则名称",size:"medium",clearable:""},model:{value:e.ruleForm.ruleName,callback:function(t){e.$set(e.ruleForm,"ruleName",t)},expression:"ruleForm.ruleName"}})],1),e._v(" "),r("el-form-item",{staticClass:"ruleConItem noBorder pd_0",attrs:{label:"规则执行条件：",prop:"logic"}},[r("el-radio-group",{class:{solid_red:e.vLock&&!e.ruleForm.logic},model:{value:e.ruleForm.logic,callback:function(t){e.$set(e.ruleForm,"logic",e._n(t))},expression:"ruleForm.logic"}},["look"!=e.$route.query.type||2==e.item.logic?r("el-radio",{attrs:{label:2}},[e._v("满足任意条件")]):e._e(),e._v(" "),"look"!=e.$route.query.type||1==e.item.logic?r("el-radio",{attrs:{label:1}},[e._v("满足全部条件")]):e._e()],1)],1),e._v(" "),r("el-form-item",{staticClass:"ruleName",attrs:{label:"决策代码"}},[r("el-input",{staticClass:"w310",class:{solid_red:e.vLock&&!e.ruleForm.decisionCode},attrs:{placeholder:"请输入决策代码",size:"medium",clearable:""},model:{value:e.ruleForm.decisionCode,callback:function(t){e.$set(e.ruleForm,"decisionCode",t)},expression:"ruleForm.decisionCode"}})],1),e._v(" "),r("div",{staticClass:"stratForm_rule"},[r("el-form-item",{staticClass:"stratForm_bd"},[r("div",{staticClass:"ruleList"},[e.ruleForm.ruleContent.length?r("div",{staticClass:"ruleContent clear open"},[r("varItem",{ref:"varItem",staticClass:"ruleConItem overhide",attrs:{icon:e.icon,variableList:e.variableList,item:e.ruleForm,index:"",vLock:e.vLock},on:{getVarType:e.getVarType}})],1):r("div",{staticClass:"noResult bd_t_0 bd_l_0 bd_r_0"},[e._v("竟然删空了，去"),r("span",{staticClass:"f_blue pointer",on:{click:function(t){e.ruleCon_plus(e.ruleForm)}}},[e._v("添加变量")])])])]),e._v(" "),"ruleTmpAdd"!=e.$route.name&&"ruleTmpEdit"!=e.$route.name?r("el-form-item",{staticClass:"isTemplate",attrs:{label:""}},[r("el-checkbox",{attrs:{"true-label":"0","false-label":"1"},model:{value:e.ruleForm.isTemplate,callback:function(t){e.$set(e.ruleForm,"isTemplate",t)},expression:"ruleForm.isTemplate"}},[e._v("保存为规则模板")])],1):e._e()],1),e._v(" "),r("div",{staticStyle:{"margin-top":"40px"}},["look"!=e.$route.query.type?r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.saveRule}},[e._v("保存\n            ")]):e._e()],1)],1)],1)},staticRenderFns:[]};var s=r("C7Lr")(i,o,!1,function(e){r("1ts/")},"data-v-399fe3ac",null);t.default=s.exports}});