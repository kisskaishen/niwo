webpackJsonp([42],{"6Itw":function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=t("3cXf"),l=t.n(i),a=t("aA9S"),n=t.n(a),o=(t("iCZs"),t("MmFQ"),t("8ZHn")),c=t.n(o),u=(t("SVgS"),t("3XX4")),r=t.n(u),f=(t("dduJ"),t("g2dp")),y=t.n(f),d=(t("IBul"),t("yST6")),p=t.n(d),v=(t("J6se"),t("3pTu")),C=t.n(v),h=(t("H8b4"),t("W/GF")),m=t.n(h),g=(t("x5sx"),t("VhLE")),L=t.n(g),V=t("VGsm"),$=t("IvJb");$.default.use(L.a),$.default.use(m.a),$.default.use(C.a),$.default.use(p.a),$.default.use(y.a),$.default.use(r.a),$.default.use(c.a);var I={name:"pages_selectClassify",data:function(){return{pageName:"pages_selectClassify",selectClassify:{nodeId:"",lineId:"",lineValue:"",valueDescription:"",categoryName:"",policyList:[],nodetype:"line"}}},components:{noData:V.a},created:function(){this.selectClassify.nodeId=this.$route.query.nodeId,this.selectClassify.lineId=this.$route.query.lineId,this.getClassifyNode()},methods:{initLineForm:function(){var e=this;if(this.$route.query.lineValue&&"undefined"!=this.$route.query.lineValue){this.selectClassify.lineValue=1*this.$route.query.lineValue;var s=this.selectClassify.policyList.filter(function(s){return e.$route.query.lineValue==s.id})[0].policyName;this.selectClassify.valueDescription=s}},hasRepeatClassify:function(e){var s=this,t=[];jsPlumb.getConnections().map(function(e){e.sourceId.slice(4)==s.$route.query.nodeId&&t.push(e)}),console.log("当前节点的连线",t,"所有分类",e.policyList),t.map(function(t,i){console.log("点击线",s.$route.query.lineValue,"线"+i+"："+t.canvas.dataset.linevalue),t.canvas.dataset.linevalue&&s.$route.query.lineValue!=t.canvas.dataset.linevalue&&(e.policyList=e.policyList.filter(function(e){return e.id!=t.canvas.dataset.linevalue}))})},updateLineValue:function(e,s){var t=this;e&&(s.policyList.map(function(s,t){e.policyList[t]&&(s.oldId=e.policyList[t].id)}),jsPlumb.getConnections().map(function(e){s.policyList.map(function(s,i){e.canvas.dataset.linevalue==s.oldId&&(e.canvas.dataset.linevalue=s.id,t.ajaxPush.updateLine(e))}),"1"==e.canvas.dataset.selected&&(t.$route.query.lineValue=e.canvas.dataset.linevalue)}))},getClassifyNode:function(){var e=this;this.$post("/mcs/node/category/query",{nodeId:this.selectClassify.nodeId}).then(function(s){s&&(s.policyList.map(function(e){e.policyShow=!1,e.ruleList=[]}),s.policyList.push({id:-1,policyName:"其他"}),n()(e.selectClassify,s),e.initLineForm(),e.hasRepeatClassify(e.selectClassify)),e.selectClassify.clear=!s;var t=JSON.parse(l()(e.selectClassify));e.$emit("firstBindLine",t)})},clearRadio:function(e,s,t){this.selectClassify.lineValue==e.id&&(console.log("清除选中",e,s),this.selectClassify.lineValue="",this.selectClassify.valueDescription="")},changeRadio:function(e,s){e?(console.log("选择分类",e,s+1),this.selectClassify.valueDescription=e.policyName):(console.log("选择其他"),this.selectClassify.valueDescription="其他")},saveSelectClassify:function(){var e=JSON.parse(l()(this.selectClassify));this.$emit("saveForm",e)},saveSelectClassify0:function(){var e=this;this.$post("/mcs/node/line/update",{id:this.selectClassify.lineId,lineValue:this.selectClassify.lineValue,valueDescription:this.selectClassify.valueDescription}).then(function(s){e.$emit("saveForm",e.selectClassify)})}}},_={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"pages_selectClassify pd_t_20"},[e.selectClassify.policyList.length?t("el-form",{ref:"selectClassify",staticClass:"selectClassify",attrs:{model:e.selectClassify,"status-icon":""}},[t("el-form-item",{staticClass:"classifyItem",attrs:{label:"look"==e.$route.query.type?"分类：":"请选择分类：",prop:"lineValue"}},[t("el-radio-group",{model:{value:e.selectClassify.lineValue,callback:function(s){e.$set(e.selectClassify,"lineValue",e._n(s))},expression:"selectClassify.lineValue"}},e._l(e.selectClassify.policyList,function(s,i){return"look"!=e.$route.query.type||e.selectClassify.lineValue==s.id?t("el-radio",{key:i,attrs:{label:s.id},on:{change:function(t){e.changeRadio(s,i)}},nativeOn:{click:function(t){e.clearRadio(s,i)}}},[e._v(e._s(s.policyName))]):e._e()}))],1),e._v(" "),"look"!=e.$route.query.type?t("div",{staticClass:"text-center"},[t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.saveSelectClassify}},[e._v("保存")])],1):e._e()],1):t("noData",{attrs:{img:"noData",p2:"暂无配置分类"}})],1)},staticRenderFns:[]};var q=t("C7Lr")(I,_,!1,function(e){t("xwJL")},null,null);s.default=q.exports},xwJL:function(e,s){}});